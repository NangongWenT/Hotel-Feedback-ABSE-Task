# 前端连接问题诊断和修复

## 🔍 问题分析

**错误信息：** `ERR_CONNECTION_REFUSED` - localhost 拒绝了连接请求

**可能原因：**
1. ✅ 后端已启动（从终端输出确认）
2. ❌ 前端服务器未启动（端口 5173 未监听）
3. ❓ 前端启动时可能有错误

## 🔧 解决方案

### 方法 1：使用启动脚本（推荐）

运行我创建的启动脚本：

```powershell
.\启动前端.ps1
```

这个脚本会：
- 自动刷新环境变量
- 验证 Node.js 安装
- 检查前端目录
- 安装依赖（如果需要）
- 启动前端服务器

### 方法 2：手动启动前端

**步骤 1：刷新环境变量**

```powershell
$env:Path = [System.Environment]::GetEnvironmentVariable("Path","Machine") + ";" + [System.Environment]::GetEnvironmentVariable("Path","User")
```

**步骤 2：验证 Node.js**

```powershell
node --version
npm --version
```

**步骤 3：进入前端目录**

```powershell
cd "C:\Users\32353\Desktop\大四上\NLP\CW\Hotel-Feedback-ABSA-Task-main\frontend"
```

**步骤 4：检查依赖**

```powershell
# 如果 node_modules 不存在，安装依赖
if (-not (Test-Path "node_modules")) {
    npm install
}
```

**步骤 5：启动前端服务器**

```powershell
npm run dev
```

**期望输出：**
```
  VITE v5.x.x  ready in xxx ms

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
```

## 📋 完整启动流程

### 终端 1：后端（已启动 ✅）

后端已经在运行：
```
✅ 检测到CUDA，将使用GPU: NVIDIA GeForce RTX 5060 Laptop GPU
 * Running on http://127.0.0.1:5000
```

**保持这个窗口打开！**

### 终端 2：前端（需要启动）

**新开一个 PowerShell 窗口**，然后：

**选项 A：使用脚本（最简单）**
```powershell
cd "C:\Users\32353\Desktop\大四上\NLP\CW\Hotel-Feedback-ABSA-Task-main"
.\启动前端.ps1
```

**选项 B：手动启动**
```powershell
# 1. 刷新环境变量
$env:Path = [System.Environment]::GetEnvironmentVariable("Path","Machine") + ";" + [System.Environment]::GetEnvironmentVariable("Path","User")

# 2. 进入前端目录
cd "C:\Users\32353\Desktop\大四上\NLP\CW\Hotel-Feedback-ABSA-Task-main\frontend"

# 3. 启动前端
npm run dev
```

**保持这个窗口打开！**

## ✅ 验证

启动成功后，你应该能够：

1. **访问前端：** http://localhost:5173
2. **看到登录页面**
3. **使用默认账户登录：**
   - 用户名：`admin`
   - 密码：`admin123`

## 🔍 代码检查结果

我已经检查了所有相关代码，配置都是正确的：

### ✅ API 配置（frontend/src/services/api.js）
- `baseURL: '/api'` - 正确，使用相对路径
- 通过 Vite proxy 转发到后端

### ✅ Vite 配置（frontend/vite.config.js）
- 端口：5173 - 正确
- Proxy 配置：`target: 'http://localhost:5000'` - 正确
- 后端运行在 5000 端口 - 匹配 ✅

### ✅ 后端配置（backend/app.py）
- 运行在 `http://127.0.0.1:5000` - 正确
- CORS 已配置，允许 `http://localhost:5173` - 正确

### ✅ 路由配置
- React Router 配置正常
- 所有页面组件都存在

## ⚠️ 常见问题

### Q1: 启动时显示 "端口 5173 已被占用"？

**解决方案：**
1. 关闭占用端口的程序
2. 或修改 `frontend/vite.config.js` 中的端口：
   ```javascript
   server: {
     port: 5174,  // 改为其他端口
   }
   ```

### Q2: npm run dev 报错？

**检查：**
1. Node.js 版本是否正确（需要 16.0+）
2. 依赖是否完整安装（运行 `npm install`）
3. 查看具体错误信息

### Q3: 前端启动成功但无法连接后端？

**检查：**
1. 后端是否在运行（http://localhost:5000）
2. 浏览器控制台是否有错误
3. 网络连接是否正常

## 🎯 下一步

1. **启动前端服务器**（使用上面的方法）
2. **访问 http://localhost:5173**
3. **登录系统测试功能**

如果还有问题，请告诉我具体的错误信息！

