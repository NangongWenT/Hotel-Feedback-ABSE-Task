# 紧急修复 500 错误

## ⚠️ 重要：必须重启后端

编码问题已修复，但**后端必须重启**才能生效。如果后端还在运行旧代码，仍然会有 500 错误。

## 🚀 快速解决方案

### 方法 1：使用重启脚本（推荐）

```powershell
cd "C:\Users\32353\Desktop\大四上\NLP\CW\Hotel-Feedback-ABSA-Task-main"
.\快速重启后端.ps1
```

### 方法 2：手动重启

1. **找到运行后端的 PowerShell 窗口**
2. **按 `Ctrl + C` 停止服务器**
3. **重新启动**：
   ```powershell
   cd "C:\Users\32353\Desktop\大四上\NLP\CW\Hotel-Feedback-ABSA-Task-main\backend"
   .\venv\Scripts\python.exe app.py
   ```

## 🔍 验证修复

### 检查启动信息

重启后，应该看到（**没有编码错误**）：

```
[WARNING] GPU 计算能力 sm_120 不完全兼容...
[WARNING] GPU 测试失败...
将自动回退到 CPU 模式
默认管理员账户已创建: admin / admin123
 * Running on http://127.0.0.1:5000
```

**如果看到 `UnicodeEncodeError` 或 emoji 相关错误，说明还没有重启！**

### 测试登录

1. 访问 http://localhost:5173
2. 使用 `admin` / `admin123` 登录
3. 应该可以成功登录

## 📋 如果仍然失败

### 步骤 1：查看后端日志

**查看运行后端的 PowerShell 窗口**，找到：
- 登录请求时的错误信息
- 完整的堆栈跟踪

### 步骤 2：测试 API

在浏览器中访问：
- http://localhost:5000/api/health
- 应该看到：`{"status": "ok", "message": "服务运行正常"}`

### 步骤 3：检查数据库

```powershell
cd backend
.\venv\Scripts\python.exe test_db.py
```

### 步骤 4：提供错误信息

如果问题仍然存在，请提供：

1. **后端启动时的完整输出**
2. **登录时后端窗口显示的错误信息**
3. **浏览器控制台的错误**（F12 → Console）

## 🎯 已修复的问题

1. ✅ 编码问题（emoji 字符）
2. ✅ 错误处理改进
3. ✅ 数据库初始化错误处理

## ⚠️ 重要提示

**后端必须重启才能生效！** 如果后端还在运行，它使用的是旧代码，仍然会有编码错误。

## 🎉 完成！

重启后端后，登录应该可以正常工作了！

